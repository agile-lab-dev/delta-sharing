DeltaFileObject:
  required:
    - id
    - deltaSingleAction
  properties:
    id:
      type: string
    deletionVectorFileId:
      type: string
    version:
      type: integer
      format: int64
    timestamp:
      type: integer
      format: int64
    expirationTimestamp:
      type: integer
      format: int64
    deltaSingleAction:
      $ref: '#/components/schemas/DeltaSingleAction'
DeltaSingleAction:
  type: object
  description: only one field can be not null, container of delta actions such as file, add, cdf or remove see https://github.com/delta-io/delta/tree/master/kernel/kernel-api/src/main/java/io/delta/kernel/internal/actions
  properties:
    add:
      $ref: '#/components/schemas/DeltaAddFileForCDFAction'
    cdf:
      $ref: '#/components/schemas/DeltaAddCDCFileAction'
    file:
      $ref: '#/components/schemas/DeltaAddFileAction'
    remove:
      $ref: '#/components/schemas/DeltaRemoveFileAction'
DeltaAddFileForCDFAction:
  type: object
  description: see io.delta.sharing.server.model.AddFileForCDF
  properties:
    url:
      type: string
    id:
      type: string
    partitionValues:
      type: object
      additionalProperties:
        type: string
    size:
      type: integer
      format: int64
    expirationTimestamp:
      type: integer
      format: int64
    version:
      type: integer
      format: int64
    timestamp:
      type: integer
      format: int64
    stats:
      type: string
DeltaAddCDCFileAction:
  type: object
  description: see io.delta.sharing.server.model.AddCDCFile
  properties:
    url:
      type: string
    id:
      type: string
    partitionValues:
      type: object
      additionalProperties:
        type: string
    size:
      type: integer
      format: int64
    expirationTimestamp:
      type: integer
      format: int64
    timestamp:
      type: integer
      format: int64
    version:
      type: integer
      format: int64
DeltaAddFileAction:
  type: object
  description: see io.delta.sharing.server.model.AddFile
  properties:
    url:
      type: string
    id:
      type: string
    partitionValues:
      type: object
      additionalProperties:
        type: string
    size:
      type: integer
      format: int64
    stats:
      type: string
    expirationTimestamp:
      type: integer
      format: int64
    timestamp:
      type: integer
      format: int64
    version:
      type: integer
      format: int64
DeltaRemoveFileAction:
  type: object
  properties:
    url:
      type: string
    id:
      type: string
    partitionValues:
      type: object
      additionalProperties:
        type: string
    size:
      type: integer
      format: int64
    expirationTimestamp:
      type: integer
      format: int64
    timestamp:
      type: integer
      format: int64
    version:
      type: integer
      format: int64
# This is undocumented, need to add to the protocol
#DeltaEndStreamAction:
#  description: An action that is returned as the last line of the streaming response. It allows the server to include additional data that might be dynamically generated while the streaming message is sent
#  type: object
#  properties:
#    refreshToken:
#      type: string
#      description: a token used to refresh pre-signed urls for a long running query
#    nextPageToken:
#      type: string
#      description: a token used to retrieve the subsequent page of a query
#    minUrlExpirationTimestamp:
#      description: the minimum url expiration timestamp of the urls returned in current response
#      type: integer
#      format: int64